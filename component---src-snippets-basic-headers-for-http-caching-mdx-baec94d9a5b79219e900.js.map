{"version":3,"file":"component---src-snippets-basic-headers-for-http-caching-mdx-baec94d9a5b79219e900.js","mappings":"+PAQaA,EAAe,GACtBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAT,GAGX,IAFFC,EAEC,EAFDA,WACGC,GACF,YACD,OAAO,QAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,eAG5E,2BACA,kBAAG,gBAAMC,WAAW,IAChB,UAAa,iBADd,QAAH,yEAGA,kBAAG,kBAAQA,WAAW,KAAnB,aACH,mBACE,cAAIA,WAAW,MAAf,kDAAsE,gBAAMA,WAAW,KACnF,UAAa,iBADqD,QAAtE,yBAGA,cAAIA,WAAW,MAAf,6CAAiE,gBAAMA,WAAW,KAC9E,UAAa,iBADgD,iBAAjE,0CAEuE,gBAAMA,WAAW,KACpF,UAAa,iBADsD,SAGrE,cAAIA,WAAW,OACb,cAAIA,WAAW,MAAf,4BAAgD,gBAAMA,WAAW,KAC7D,UAAa,iBAD+B,OAAhD,uCAGA,cAAIA,WAAW,MAAf,iCAAqD,gBAAMA,WAAW,KAClE,UAAa,iBADoC,QAArD,gCAMN,8BACA,kBAAG,gBAAMA,WAAW,IAChB,UAAa,iBADd,WAAH,yDAEgF,gBAAMA,WAAW,IAC7F,UAAa,iBAD+D,KAFhF,cAKA,kBAAG,kBAAQA,WAAW,KAAnB,aACH,mBACE,cAAIA,WAAW,MAAf,kDAAsE,gBAAMA,WAAW,KACnF,UAAa,iBADqD,aAAtE,YAEqC,gBAAMA,WAAW,KAClD,UAAa,iBADoB,QAFrC,sCAKA,cAAIA,WAAW,MAAf,+BACE,cAAIA,WAAW,OACb,cAAIA,WAAW,MAAf,6DAAiF,gBAAMA,WAAW,KAC9F,UAAa,iBADgE,KAAjF,yDAE0E,gBAAMA,WAAW,KACvF,UAAa,iBADyD,WAF1E,aAIoC,gBAAMA,WAAW,KACjD,UAAa,iBADmB,QAJpC,sBAM0C,gBAAMA,WAAW,KACvD,UAAa,iBADyB,cAN1C,QAQkC,gBAAMA,WAAW,KAC/C,UAAa,iBADiB,gBARlC,MAWA,cAAIA,WAAW,MAAf,qDAAyE,gBAAMA,WAAW,KACtF,UAAa,iBADwD,KAAzE,oEAMN,kBAAG,cAAIA,WAAW,KAAf,mIAAH,MACA,kCACA,kBAAG,gBAAMA,WAAW,IAChB,UAAa,iBADd,WAAH,+GAEsI,gBAAMA,WAAW,IACnJ,UAAa,iBADqH,aAFtI,4EAIqG,gBAAMA,WAAW,IAClH,UAAa,iBADoF,WAJrG,gDAOc,gBAAMA,WAAW,IAC3B,UAAa,iBADH,aAPd,UASmC,gBAAMA,WAAW,IAChD,UAAa,iBADkB,WATnC,8EAYA,kBAAG,cAAIA,WAAW,KAAf,oFAAH,MACA,6CACA,kBAAG,gBAAMA,WAAW,IAChB,UAAa,iBADd,0BAAH,gLAGA,kBAAG,kBAAQA,WAAW,KAAnB,aACH,mBACE,cAAIA,WAAW,MAAf,kDAAsE,gBAAMA,WAAW,KACnF,UAAa,iBADqD,sCAAtE,YAE8D,gBAAMA,WAAW,KAC3E,UAAa,iBAD6C,QAF9D,SAI6B,gBAAMA,WAAW,KAC1C,UAAa,iBADY,QAJ7B,sCAOA,cAAIA,WAAW,MAAf,+BACE,cAAIA,WAAW,OACb,cAAIA,WAAW,MAAf,6DAAiF,gBAAMA,WAAW,KAC9F,UAAa,iBADgE,KAAjF,mCAGA,cAAIA,WAAW,MAAf,6DAAiF,gBAAMA,WAAW,KAC9F,UAAa,iBADgE,KAAjF,2BAE4C,gBAAMA,WAAW,KACzD,UAAa,iBAD2B,WAF5C,8EAKA,cAAIA,WAAW,MAAf,+DAAmF,gBAAMA,WAAW,KAChG,UAAa,iBADkE,KAAnF,2BAE4C,gBAAMA,WAAW,KACzD,UAAa,iBAD2B,WAF5C,SAIgC,gBAAMA,WAAW,KAC7C,UAAa,iBADe,0BAJhC,8FAcVJ,EAAWK,gBAAiB,G,iGCzHtBJ,EAAa,GAEJ,SAASK,EAAT,GAAgD,IAA1BC,EAAyB,EAAzBA,SAC3BC,EADoD,EAAfC,YACrCD,YACFE,EAAS,SAAYF,EAAYE,UAEvC,OACE,gBAAC,KAAD,CAAaT,WAAYA,GACvB,gBAAC,IAAD,KACE,gBAAC,IAAD,KACE,wBAAMU,KAAK,OAEX,6BAAQH,EAAYI,OAEpB,wBAAMC,KAAK,cAAcC,QAASN,EAAYO,UAC9C,wBAAMC,SAAS,iBAAiBF,QAASN,EAAYO,UAErD,wBACEF,KAAK,WACLC,QAAQ,yFAGV,wBAAME,SAAS,WAAWF,QAASN,EAAYI,QAC/C,wBAAMI,SAAS,WAAWF,QAASJ,IAEnC,wBAAMG,KAAK,SAASC,QAAQ,oBAG9B,wBAAM,kBAAgB,QAAQG,UAAU,WACtC,sBAAIC,GAAG,SAASV,EAAYI,OAC3BL,O,qBCrCI,SAASY,EAA8BC,EAAQC,GAC5D,GAAc,MAAVD,EAAgB,MAAO,GAC3B,IAEIE,EAAKC,EAFLC,EAAS,GACTC,EAAaC,OAAOC,KAAKP,GAG7B,IAAKG,EAAI,EAAGA,EAAIE,EAAWG,OAAQL,IACjCD,EAAMG,EAAWF,GACbF,EAASQ,QAAQP,IAAQ,IAC7BE,EAAOF,GAAOF,EAAOE,IAGvB,OAAOE,E","sources":["webpack://marvin-frachet/./src/snippets/basic-headers-for-http-caching.mdx","webpack://marvin-frachet/./src/layouts/posts-layout.js","webpack://marvin-frachet/./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/marvin/soft/mfrachet.github.io-gatsby/src/layouts/posts-layout.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Etag`}</h2>\n    <p><code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`etat`}</code>{` means \"Entity Tag\". It aims to set the version of a given resource.`}</p>\n    <p><strong parentName=\"p\">{`A flow:`}</strong></p>\n    <ul>\n      <li parentName=\"ul\">{`When creating a response on the server, put a `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`etag`}</code>{` header with a value`}</li>\n      <li parentName=\"ul\">{`When a new request comes in, compare the `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`if-none-match`}</code>{` header with the previously generated `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`etag`}</code>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`If they match, return a `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`304`}</code>{` and forget about setting the body`}</li>\n          <li parentName=\"ul\">{`If they don't match, set the `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`etag`}</code>{` and repeat this process`}</li>\n        </ul>\n      </li>\n    </ul>\n    <h2>{`max-age`}</h2>\n    <p><code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`max-age`}</code>{` allows to cache an HTTP response in the browser for `}<code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`N`}</code>{` seconds.`}</p>\n    <p><strong parentName=\"p\">{`A flow:`}</strong></p>\n    <ul>\n      <li parentName=\"ul\">{`When creating a response on the server, put a `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`max-age=N`}</code>{` (here, `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`N=10`}</code>{`) header with a number of seconds`}</li>\n      <li parentName=\"ul\">{`When a new request comes in`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`If the user has already visited the page during the last `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`N`}</code>{` seconds, get the response from the cache (in chrome `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`Network`}</code>{`, in the `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`Size`}</code>{` column, there is `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`disk-cache`}</code>{` or `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`memory-cache`}</code>{`)`}</li>\n          <li parentName=\"ul\">{`If the user has not visited the page the page in `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`N`}</code>{` seconds after its last visit, then, make a new HTTP request`}</li>\n        </ul>\n      </li>\n    </ul>\n    <p><em parentName=\"p\">{`Hint: putting a very high max-age on static assets generated with hashes, like webpack build artifacts is generally a good idea`}</em>{`.`}</p>\n    <h2>{`CDN caching`}</h2>\n    <p><code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`max-age`}</code>{` is also used by CDN. If people want to define two different values for the CDN and for the origin server, `}<code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`s-max-age`}</code>{` can be set and the CDN will only take care of this one and forward the `}<code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`max-age`}</code>{` one to the origin server.\nHaving a bigger `}<code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`s-max-age`}</code>{` than `}<code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`max-age`}</code>{` is often better since we don't want to ping the origin server too often.`}</p>\n    <p><em parentName=\"p\">{`Hint: it's generally possible to purge a CDN from their UIs or using remote APIs`}</em>{`.`}</p>\n    <h3>{`stale-while-revalidate`}</h3>\n    <p><code parentName=\"p\" {...{\n        \"className\": \"language-text\"\n      }}>{`stale-while-revalidate`}</code>{` allows to return a stale (and cached) version of the content to users for a given period of time but in the meantime, it refreshes its cache by calling the origin server.`}</p>\n    <p><strong parentName=\"p\">{`A flow:`}</strong></p>\n    <ul>\n      <li parentName=\"ul\">{`When creating a response on the server, put a `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`max-age=N,stale-while-revalidate=S`}</code>{` (here, `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`N=10`}</code>{` and `}<code parentName=\"li\" {...{\n          \"className\": \"language-text\"\n        }}>{`S=20`}</code>{`) header with a number of seconds`}</li>\n      <li parentName=\"ul\">{`When a new request comes in`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`If the user has already visited the page during the last `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`N`}</code>{` seconds, get the cached value`}</li>\n          <li parentName=\"ul\">{`If the user has already visited the page during the last `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`S`}</code>{` seconds, meaning that `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`max-age`}</code>{` has expired, still get the cached value BUT revalidate in the background`}</li>\n          <li parentName=\"ul\">{`If the user has not visited the page again during the last `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`S`}</code>{` seconds, meaning that `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`max-age`}</code>{` and `}<code parentName=\"li\" {...{\n              \"className\": \"language-text\"\n            }}>{`stale-while-revalidate`}</code>{` has expired, then, the request will hit the origin server, and populate the CDN cache`}</li>\n        </ul>\n      </li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","import React from \"react\";\nimport { MDXProvider } from \"@mdx-js/react\";\nimport { Helmet } from \"react-helmet\";\nimport \"../styles/reset.css\";\nimport \"../styles/index.css\";\nimport { AppLayout } from \"./app-layout\";\n\nconst components = {};\n\nexport default function PostLayout({ children, pageContext }) {\n  const { frontmatter } = pageContext;\n  const metaImage = `/meta/${frontmatter.metaImage}`;\n\n  return (\n    <MDXProvider components={components}>\n      <AppLayout>\n        <Helmet>\n          <html lang=\"en\" />\n\n          <title>{frontmatter.title}</title>\n\n          <meta name=\"description\" content={frontmatter.excerpt} />\n          <meta property=\"og:description\" content={frontmatter.excerpt} />\n\n          <meta\n            name=\"keywords\"\n            content=\"HTML, CSS, JavaScript, Accessibility, A11y, e2e, tests, testing, React, React Native\"\n          />\n\n          <meta property=\"og:title\" content={frontmatter.title} />\n          <meta property=\"og:image\" content={metaImage} />\n\n          <meta name=\"author\" content=\"Marvin Frachet\" />\n        </Helmet>\n\n        <main aria-labelledby=\"title\" className=\"wrapper\">\n          <h1 id=\"title\">{frontmatter.title}</h1>\n          {children}\n        </main>\n      </AppLayout>\n    </MDXProvider>\n  );\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent","PostLayout","children","frontmatter","pageContext","metaImage","lang","title","name","content","excerpt","property","className","id","_objectWithoutPropertiesLoose","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf"],"sourceRoot":""}